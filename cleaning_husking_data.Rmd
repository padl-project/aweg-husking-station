---
title: "Cleaning Husking Satation Data"
author: "Camila Vargas"
date: "11/17/2021"
output: html_document
---

This scripts cleans, organize and QA/QC Alex Wegmann data on Husking Station Analysis data.

The outcome data of this script will be publicly available in the Environmental Data Initiative data portal.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(here)
library(data.table)
library(tidyverse)
library(readxl)
library(janitor)
library(lubridate)

## Sets R not to use scientific notations
options(scipen=999) 

```


## Read data
```{r}
excel_sheets("6.raw_data/HuskingStationAnalysis.xls")

rat_stations_raw <- read_excel(here::here("6.raw_data/HuskingStationAnalysis.xls"), sheet = "Rat_stations") %>%
  clean_names()

rat_crab_stat_raw <-  read_excel(here::here("6.raw_data/HuskingStationAnalysis.xls"), sheet = "Rat-crab stations") %>%
  clean_names() %>% 
  select(1:17)

```


We are only using data from 2 sheets: Rat Station and Rat-crab stations. The rest seems to have no data pull data form this two main data sets for a specific analysis.

Ask Alex: Do we need any other sheet? Is the data for ch 1 fig 3 sheet necessary or a compilation/restructure version of the two main sheets we are looking at.

## Cleaning
Steps:
1. Change n/a to actual NAs
2. Remove units from colnames
3. Standardize colnames between both data sets


```{r}

rat_station_clean <- rat_stations_raw %>% 
  ##remove number in front of variable name
  rename_at(vars(matches("number_")), ~str_remove(., "number_")) %>%
  rename_at(vars(12,15), ~str_remove(., "of_")) %>% 
  rename_at(vars(matches("_mm")), ~str_remove(., "_mm")) %>%
  rename(carapace_pieces = "carapace_pieces_y_n") %>%
  mutate(across(8:18, ~replace(.,.== "n/a", NA)))

rat_crab_clean <- rat_crab_stat_raw %>% 
  rename_at(vars(matches("_mm")), ~str_remove(., "_mm")) %>% 
  rename(carapace_pieces = "carapace_pieces_inc_gastrod_shell_used_by_coenobita_y_n")

```

## Save


```{r}
write_csv(rat_station_clean, here::here("7.clean_data/2004_2005_palmyra_atoll_rat_husking.csv"))

write_csv(rat_crab_clean, here::here("7.clean_data/2004_2005_palmyra_atoll_rat_crab_husking.csv"))

```





